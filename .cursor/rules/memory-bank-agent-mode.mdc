---
description: Memory Bank в Agent/Composer — триггеры без Chat
alwaysApply: true
---

# Memory Bank в Agent mode (Composer)

Пользователь работает в **Agent mode (Composer)**. Slash-команды (`/van`, `/plan` и т.д.) в Cursor отображаются только в Chat, но **тот же workflow нужно выполнять здесь**, когда пользователь явно запускает фазу Memory Bank.

## Триггеры (в начале сообщения или по смыслу)

Если пользователь пишет в Composer что-то из списка ниже — выполнять **соответствующую фазу Memory Bank**, как описано в `.cursor/commands/<phase>.md` и в правилах `.cursor/rules/isolation_rules/`.

| Что пишет пользователь | Фаза | Действие |
|------------------------|------|----------|
| **van** … / **ван** … / **старт задачи** … / **новая задача** … | VAN | Инициализация: прочитать/создать memory-bank/, определить сложность (1–4), обновить tasks.md, activeContext.md; предложить следующий шаг (/plan или /build). |
| **plan** / **план** / **спланировать** | PLAN | Планирование: читать tasks.md, activeContext.md, projectbrief.md; составить план, обновить tasks.md; **предложить** следующий шаг (/creative или /build). Не переходить к реализации кода до явного запроса пользователя (build/билд/реализуй или /build). |
| **creative** / **креатив** / **дизайн** | CREATIVE | Креативная фаза: варианты решений, документы в memory-bank/creative/, обновить tasks.md. |
| **build** / **билд** / **реализуй** / **сделай** | BUILD | Реализация: по плану и creative-документам; обновлять tasks.md, progress.md. |
| **reflect** / **рефлексия** / **итоги** | REFLECT | Рефлексия: создать memory-bank/reflection/reflection-[task_id].md, обновить tasks.md. |
| **archive** / **архив** / **завершить задачу** | ARCHIVE | Архив: создать memory-bank/archive/archive-[task_id].md, обновить tasks.md, progress.md, сбросить activeContext.md. |

## Как выполнять

1. **Определить фазу** по первому слову/фразе или по явному намерению («давай спланируем» → plan).
2. **Прочитать** соответствующий файл из `.cursor/commands/` (van.md, plan.md, build.md и т.д.) и при необходимости правила из `.cursor/rules/isolation_rules/` для этой фазы.
3. **Прочитать/обновить** файлы в `memory-bank/` по инструкциям этой фазы (tasks.md, activeContext.md, progress.md и т.д.).
4. **Выполнить** шаги фазы и в конце явно предложить следующий шаг (например: «Готово. Дальше: `/build` или напиши **build**»). После PLAN (и после CREATIVE, если был) **не начинать реализацию** — менять код только после того, как пользователь явно попросит build (напишет **build** / **билд** / **реализуй** или вызовет `/build`).

## Важно

- Контекст Memory Bank хранится в `memory-bank/`. Перед фазой читай tasks.md и при необходимости activeContext.md, projectbrief.md.
- Если пользователь просто описывает задачу без явного «van»/«план» — можно один раз уточнить: «Запускаем как новую задачу Memory Bank? Напиши **van** и описание — инициализирую.»

Таким образом пользователь может вести весь workflow Memory Bank **здесь, в Composer**, без перехода в Chat.
