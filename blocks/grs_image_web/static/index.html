<!DOCTYPE html>
<html lang="ru" id="html-theme" class="theme-dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî FLOW</title>
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" />
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link href="/static/style.css" rel="stylesheet" />
</head>
<body class="page-body min-h-screen">
  <div id="app" class="container mx-auto px-3 sm:px-6 py-4 sm:py-6 max-w-3xl">
    <!-- –®–∞–ø–∫–∞: 1) —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫; 2) —Å–ª–µ–≤–∞ ‚Äî —Ç–µ–º–∞, —Å–ø—Ä–∞–≤–∞ ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ò—Å—Ç–æ—Ä–∏—è -->
    <header class="mb-6 space-y-3">
      <div>
        <h1 class="text-xl sm:text-2xl font-bold page-title">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h1>
        <p class="text-sm page-subtitle">GRS AI ¬∑ nano-banana</p>
      </div>
      <div class="flex items-center justify-between gap-3">
        <button type="button" id="btn-theme" class="theme-btn px-3 py-1.5 rounded-lg text-sm border" aria-label="–¢–µ–º–∞">üåì</button>
        <div id="header-auth" class="flex items-center gap-2">
          <span id="user-name" class="page-subtitle text-sm hidden"></span>
          <button type="button" id="btn-logout" class="header-btn px-3 py-1.5 rounded-lg text-sm hidden">–í—ã–π—Ç–∏</button>
        </div>
      </div>
      <div class="flex items-center justify-between gap-3">
        <button type="button" id="btn-new-generation" class="header-btn px-4 py-2 rounded-lg text-sm hidden">–ù–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</button>
        <button type="button" id="btn-history" class="header-btn px-4 py-2 rounded-lg text-sm hidden">–ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</button>
      </div>
    </header>

    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Telegram -->
    <section id="screen-login" class="card p-6 text-center">
      <p class="mb-4 input-label">–í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram, —á—Ç–æ–±—ã –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤ —Å–≤–æ—ë–º –∞–∫–∫–∞—É–Ω—Ç–µ.</p>
      <div id="telegram-login-container"></div>
      <p id="login-no-bot" class="text-amber-500 text-sm mt-4 hidden">–ë–æ—Ç –¥–ª—è –≤—Ö–æ–¥–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –£–∫–∞–∂–∏—Ç–µ GRS_IMAGE_WEB_BOT_USERNAME –≤ .env</p>
    </section>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω: —Ñ–æ—Ä–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
    <main id="screen-main" class="hidden space-y-6">
      <!-- –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã -->
      <section class="card p-4">
        <label class="block input-label text-sm uppercase tracking-wide mb-3">–†–µ—Ñ–µ—Ä–µ–Ω—Å—ã (–¥–æ 5 —Ñ–æ—Ç–æ)</label>
        <div id="refs-container" class="space-y-3">
          <div class="ref-row flex items-center gap-3 flex-wrap">
            <div class="ref-preview-wrap hidden">
              <img class="ref-preview hidden" alt="" />
              <span class="ref-preview-placeholder input-label">‚Äî</span>
            </div>
            <input type="file" accept="image/*" class="ref-input text-sm file:mr-2 file:py-1.5 file:px-3 file:rounded file:border-0" />
            <button type="button" class="ref-remove hidden" aria-label="–£–¥–∞–ª–∏—Ç—å —Ä–µ—Ñ–µ—Ä–µ–Ω—Å">√ó</button>
          </div>
        </div>
        <button type="button" id="btn-add-ref" class="mt-2 px-3 py-1.5 rounded text-sm btn-secondary hidden">+ –î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ñ–µ—Ä–µ–Ω—Å</button>
      </section>

      <!-- –ü—Ä–æ–º–ø—Ç -->
      <section class="card p-4">
        <label class="block text-sm uppercase tracking-wide mb-2 input-label">–ü—Ä–æ–º–ø—Ç</label>
        <textarea id="prompt-input" rows="4" class="w-full rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent input-area" placeholder="–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏‚Ä¶"></textarea>
        <button type="button" id="btn-improve-prompt" class="mt-2 px-3 py-1.5 rounded text-sm btn-secondary">–£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–º–ø—Ç</button>
        <!-- –ü–∞–Ω–µ–ª—å —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è) -->
        <div id="improved-prompt-panel" class="mt-3 hidden border-t pt-3 border-divider">
          <label class="block text-sm uppercase tracking-wide mb-2 input-label">–£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–ò–ò)</label>
          <textarea id="improved-prompt-input" rows="4" class="w-full rounded-lg p-3 text-sm input-area" placeholder="–ù–∞–∂–º–∏—Ç–µ ¬´–£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–º–ø—Ç¬ª‚Ä¶"></textarea>
          <div class="mt-3 flex items-center gap-3">
            <span class="text-sm input-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:</span>
            <label class="flex items-center gap-1.5 cursor-pointer">
              <input type="radio" name="prompt-source" value="mine" checked class="prompt-radio" />
              <span class="text-sm">–º–æ–π –ø—Ä–æ–º–ø—Ç</span>
            </label>
            <label class="flex items-center gap-1.5 cursor-pointer">
              <input type="radio" name="prompt-source" value="improved" class="prompt-radio" />
              <span class="text-sm">–Ω–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç</span>
            </label>
          </div>
        </div>
      </section>

      <!-- –§–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ) -->
      <section class="card p-4">
        <label class="block text-sm uppercase tracking-wide mb-2 input-label">–§–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
        <select id="format-select" class="w-full max-w-xs rounded-lg p-2 text-sm input-area focus:ring-2 focus:ring-blue-500">
          <option value="1024x1024">1:1 (–∫–≤–∞–¥—Ä–∞—Ç)</option>
          <option value="1024x768">4:3 (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π)</option>
          <option value="768x1024">3:4 (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π)</option>
          <option value="1024x576">16:9 (—à–∏—Ä–æ–∫–∏–π)</option>
          <option value="576x1024">9:16 (–≤—ã—Å–æ–∫–∏–π)</option>
        </select>
      </section>

      <button type="button" id="btn-generate" class="w-full py-3 rounded-lg font-medium btn-primary transition-colors">–ù–∞—á–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é</button>

      <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ -->
      <section id="loading-section" class="card p-6 text-center hidden">
        <p class="input-label text-sm mb-4">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è‚Ä¶</p>
        <img src="/static/nyan.gif" alt="" class="loading-gif mb-4" onerror="this.style.display='none'; if(this.nextElementSibling) this.nextElementSibling.classList.remove('hidden');" />
        <div class="loading-gif-fallback hidden text-4xl mb-4" aria-hidden="true">üê± ‚ú®</div>
        <div id="facts-carousel" class="facts-carousel flex items-center gap-3">
          <button type="button" id="fact-prev" class="facts-nav p-2 rounded" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ñ–∞–∫—Ç">‚Üê</button>
          <p id="fact-text" class="flex-1 text-sm min-h-[2.5rem]"></p>
          <button type="button" id="fact-next" class="facts-nav p-2 rounded" aria-label="–°–ª–µ–¥—É—é—â–∏–π —Ñ–∞–∫—Ç">‚Üí</button>
        </div>
      </section>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–µ–≤—å—é + –°–∫–∞—á–∞—Ç—å / –°–¥–µ–ª–∞—Ç—å –∑–∞–Ω–æ–≤–æ -->
      <section id="result-section" class="card p-6 hidden">
        <p class="input-label text-sm mb-3">–†–µ–∑—É–ª—å—Ç–∞—Ç</p>
        <div id="result-preview-wrap" class="mb-4 rounded-lg overflow-hidden result-preview-bg">
          <img id="result-preview" src="" alt="–†–µ–∑—É–ª—å—Ç–∞—Ç" class="max-w-full h-auto" />
        </div>
        <div class="flex gap-2">
          <a id="btn-download" href="#" download class="flex-1 py-2 rounded-lg text-center font-medium btn-download">–°–∫–∞—á–∞—Ç—å</a>
          <button type="button" id="btn-retry" class="flex-1 py-2 rounded-lg font-medium btn-primary">–°–¥–µ–ª–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
        </div>
      </section>
    </main>

    <!-- –ü–æ–ø–∞–ø –∏—Å—Ç–æ—Ä–∏–∏ -->
    <div id="history-popup" class="popup-overlay hidden" aria-hidden="true">
      <div class="popup-card">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-semibold page-title">–ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</h2>
          <button type="button" id="history-close" class="p-2 rounded input-label hover:opacity-80 popup-close-btn" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
        </div>
        <div id="history-list" class="history-list overflow-y-auto space-y-3">
          <p id="history-empty" class="input-label text-sm">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</p>
        </div>
      </div>
    </div>
  </div>

  <footer class="mt-12 py-6 text-center text-sm footer-text">
    <p class="flex flex-wrap items-center justify-center sm:justify-between gap-x-4 gap-y-1 max-w-3xl mx-auto px-3">
      <span>Powered by FLOW. All rights reserved.</span>
      <a href="/links" class="footer-link">–°—Å—ã–ª–∫–∏</a>
    </p>
    <p class="mt-1"><a href="https://flowcabinet.ru" target="_blank" rel="noopener" class="footer-link">flowcabinet.ru</a></p>
  </footer>

  <script src="/static/app.js"></script>
</body>
</html>
